{
  "Resources": {
    "mycanaryServiceBucketF66DFA57": {
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain"
    },
    "mycanaryServiceRoleEE2F0C82": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "s3:PutObject",
                    "s3:GetBucketLocation",
                    "s3:ListAllMyBuckets",
                    "cloudwatch:PutMetricData",
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents"
                  ],
                  "Effect": "Allow",
                  "Resource": "*"
                }
              ],
              "Version": "2012-10-17"
            },
            "PolicyName": "canaryPolicy"
          }
        ]
      }
    },
    "mycanaryDCC21B3D": {
      "Type": "AWS::Synthetics::Canary",
      "Properties": {
        "ArtifactS3Location": {
          "Fn::Join": [
            "",
            [
              "s3://",
              {
                "Ref": "mycanaryServiceBucketF66DFA57"
              }
            ]
          ]
        },
        "Code": {
          "Handler": "index.handler",
          "Script": "foo"
        },
        "ExecutionRoleArn": {
          "Fn::GetAtt": [
            "mycanaryServiceRoleEE2F0C82",
            "Arn"
          ]
        },
        "Name": "integalarmcanary",
        "RunConfig": {
          "TimeoutInSeconds": 60
        },
        "RuntimeVersion": "syn-1.0",
        "Schedule": {
          "DurationInSeconds": "0",
          "Expression": "rate(1 minute)"
        },
        "StartCanaryAfterCreation": true
      },
      "DependsOn": [
        "mycanaryServiceRoleEE2F0C82"
      ]
    },
    "mycanarycanaryAlarm015687B3": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "EvaluationPeriods": 2,
        "AlarmName": "myCanaryAlarm",
        "Dimensions": [
          {
            "Name": "CanaryName",
            "Value": {
              "Ref": "mycanaryDCC21B3D"
            }
          }
        ],
        "MetricName": "Failed",
        "Namespace": "CloudWatchSynthetics",
        "Period": 300,
        "Statistic": "Average",
        "Threshold": 1
      }
    }
  }
}